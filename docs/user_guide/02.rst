
Acquiring seismic data
======================

Acquiring and quality control checking seismic data can be one of the most challenging steps in an inversion.  This page describes our preferred data client and MTUQ's data and metadata format requirements.


Data acquisition clients
------------------------

`ObsPy FDSN clients <https://docs.obspy.org/packages/obspy.clients.fdsn.html>`_ provide a way of programmatically downloading waveforms from `IRIS <https://www.iris.edu>`_. `PySEP <https://github.com/mtuqorg/pysep>`_ is a wrapper around an ObsPy FDSN client and our preferred data acquisition tool.  

Besides downloading waveforms through ObsPy calls, PySEP performs data processing and quality control, ensuring that the data processing and time discretization requirements below are satisfied.  

Additionally, PySEP generates "weight files" that can optionally be used by `mtuq.process_data` to control the relative contribution of different stations to the data misfit function.


File format, metadata, and data processing requirements
-------------------------------------------------------

SAC is the only natively supported file format.

The following information must be present in the SAC metadata headers: `station latitude`, `station longitude`, `network code`, `station code`, `location code` and trace `start time`.  

It is expected that the following data processing steps have been carried out prior to reading user-supplied waveforms by mtuq.read:

- instrument response must have already ben removed
- traces must be rotated into vertical (Z), radial (R) and transverse (T) components
- all traces have the same sampling rate


Other file formats
------------------

Support for other file formats can be added by end users through a `plug-in system <https://mtuqorg.github.io/mtuq/user_guide/02/devel.html#other-file-formats>`_.


More information
----------------

When downloading SAC files from FDSN data providers, the above metadata requirements are usually satisfied. 

In other cases, such as setting up a synthetic inversion or working with legacy providers, a lot of effort can be required to meet the requirements above.  

`More detailed notes <https://mtuqorg.github.io/mtuq/user_guide/02/notes.html>`_ are currently under construction to help in such cases.


